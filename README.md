# متجر أريبا الإلكتروني - بوابة الدفع

## نظرة عامة

هذا مشروع Next.js يوضح كيفية دمج بوابة الدفع الخاصة بشركة أريبا في تطبيق إلكتروني. النظام يدعم المعاملات المتكررة ويحتوي على جميع صفحات النجاح والإلغاء والخطأ والـ callback.

## الميزات

- ✅ دعم المعاملات المتكررة (كل ضغطة على زر الشراء تنشئ معاملة جديدة)
- ✅ صفحة نجاح الدفع مع تفاصيل المعاملة
- ✅ صفحة إلغاء الدفع
- ✅ صفحة خطأ الدفع
- ✅ نظام callback متقدم لاستلام إشعارات الدفع
- ✅ واجهة مستخدم جميلة ومتجاوبة
- ✅ دعم اللغة العربية
- ✅ تسجيل مفصل لجميع العمليات

## البنية

```
src/
├── app/
│   ├── api/payment/
│   │   ├── initiate/route.ts     # بدء عملية الدفع
│   │   └── callback/route.ts     # استلام إشعارات الدفع
│   ├── payment/
│   │   ├── checkout/page.tsx     # صفحة إدخال بيانات الدفع
│   │   ├── success/page.tsx      # صفحة نجاح الدفع
│   │   ├── cancel/page.tsx       # صفحة إلغاء الدفع
│   │   └── error/page.tsx        # صفحة خطأ الدفع
│   └── page.tsx                  # الصفحة الرئيسية
└── lib/
    └── areeba-config.ts          # إعدادات بوابة الدفع
```

## كيفية العمل

### 1. بدء عملية الدفع
- المستخدم يضغط على زر "شراء الآن" في الصفحة الرئيسية
- يتم توجيهه إلى صفحة الدفع المحلية
- يتم إنشاء معرف معاملة فريد لكل عملية دفع

### 2. إنشاء المعاملة
- يتم إرسال طلب إلى بوابة الدفع مع البيانات المطلوبة
- يتم تضمين روابط النجاح والإلغاء والخطأ والـ callback
- كل معاملة لها معرف فريد يضمن عدم التكرار

### 3. صفحات النتيجة
- **صفحة النجاح**: تعرض تفاصيل الدفع الناجح
- **صفحة الإلغاء**: تعرض رسالة إلغاء الدفع
- **صفحة الخطأ**: تعرض تفاصيل الخطأ الذي حدث
- **صفحة الـ callback**: تستلم إشعارات من بوابة الدفع

## الإعدادات

### ملف `src/lib/areeba-config.ts`
```typescript
export const AREEBA_CONFIG = {
  MERCHANT_ID: 'IQ3093980103',
  API_KEY: 'TESTKEYIQ3093980103',
  BASE_URL: 'https://gateway.areebapayment.com/api/v3',
  AUTH: {
    USERNAME: 'Ali.112233445566',
    PASSWORD: 'Zxxznmmn@123'
  }
};
```

## التشغيل

1. تثبيت المتطلبات:
```bash
npm install
```

2. تشغيل المشروع:
```bash
npm run dev
```

3. فتح المتصفح على:
```
http://localhost:3000
```

## اختبار النظام

### بيانات البطاقة التجريبية
- **رقم البطاقة**: 5123 4500 0000 0008
- **تاريخ الانتهاء**: 01/39
- **رمز الأمان**: 123
- **اسم حامل البطاقة**: test

### سيناريوهات الاختبار
1. **الدفع الناجح**: استخدم البيانات التجريبية لإتمام الدفع بنجاح
2. **إلغاء الدفع**: اضغط على زر الإلغاء في بوابة الدفع
3. **خطأ في الدفع**: استخدم بيانات بطاقة غير صحيحة
4. **المعاملات المتكررة**: اضغط على زر الشراء عدة مرات لإنشاء معاملات جديدة

## التسجيل والمراقبة

النظام يقوم بتسجيل جميع العمليات في console:
- بدء المعاملات الجديدة
- استلام إشعارات الدفع
- تفاصيل النجاح والفشل والإلغاء
- أخطاء الاتصال

## الأمان

- جميع البيانات مشفرة
- استخدام HTTPS للاتصالات
- التحقق من صحة البيانات المدخلة
- معالجة آمنة للأخطاء

## الدعم

للمساعدة أو الاستفسارات، يرجى التواصل مع فريق التطوير.

---

© 2024 متجر أريبا الإلكتروني - جميع الحقوق محفوظة
